<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
    <link rel="stylesheet" href="Scripts/element-ui-2.4.5/index.css" />
    <!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/element-ui/2.4.5/theme-chalk/index.css"/>-->
    <style type="text/css">
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f2f2f2; }
        ::-webkit-scrollbar-thumb { background: #ccc; }
        a, a:active, a:hover, a:focus { text-decoration: none; }
    </style>
</head>
<body>
    <div id="app" style="position:absolute;top:0;left:0;width:100%;height:100%;">
        <el-container style="height:100%;width:100%;" v-loading="loading">
            <el-header style="background-color:#909399;color:#fff;font-weight:bold;line-height:60px;">
                <el-row>
                    <el-col :span="24"><div class="grid-content bg-purple-dark">亚马逊日本站商品排名</div></el-col>
                </el-row>
            </el-header>
            <el-container>
                <el-aside width="300px" style="background-color:#545c64;overflow:hidden;">
                    <el-menu background-color="#545c64"
                             text-color="#fff"
                             :default-active="navselected"
                             :active="navselected"
                             active-text-color="#ffd04b" style="width: 100%; height: 100%; overflow: auto;">
                        <template v-for="(menu, menuIndex) in memuList">
                            <el-submenu :index="menuIndex+1+''" v-if="menu.SubMenuList && menu.SubMenuList.length>0">
                                <template slot="title">
                                    <i class="el-icon-location"></i>
                                    <span slot="title">{{menu.Name}}</span>
                                </template>
                                <template>
                                    <el-menu-item :index="(menuIndex+1)+'-1'" @click="gochart" :data-index="(menuIndex+1)+'-1'" :data-id="menu.ID">{{menu.Name}}</el-menu-item>
                                </template>
                                <template v-for="(subMenu, subMenuIndex) in menu.SubMenuList">
                                    <el-menu-item :index="((menuIndex+1)+'-'+(subMenuIndex+2))" @click="gochart" :data-index="((menuIndex+1)+'-'+(subMenuIndex+2))" :data-id="subMenu.ID">&nbsp;&nbsp;&nbsp;&nbsp;{{subMenu.Name}}</el-menu-item>
                                </template>
                            </el-submenu>
                            <el-menu-item :index="menuIndex+1+''" v-else>
                                <i class="el-icon-menu"></i>
                                <span slot="title">{{menu.Name}}</span>
                            </el-menu-item>
                        </template>
                    </el-menu>
                </el-aside>
                <el-main><router-view></router-view></el-main>
            </el-container>
        </el-container>
    </div>
    <script type="text/javascript" src="Scripts/jquery/jquery-2.2.4.min.js"></script>
    <script type="text/javascript" src="Scripts/vue-2.5.17/vue.js"></script>
    <script type="text/javascript" src="Scripts/vue-router-3.0.1/vue-router.js"></script>
    <script type="text/javascript" src="Scripts/element-ui-2.4.5/index.js"></script>
    <script type="text/javascript" src="Scripts/yepnope/yepnope-2.0.0.min.js"></script>
    <script type="text/javascript" src="Scripts/Utils.js"></script>
    <script type="text/javascript" src="Scripts/vue-component/chart.js"></script>
    <script type="text/javascript">
        $(function () {
            ({
                router: null,
                vm: null,
                createVue: function () {
                    this.router = new VueRouter({
                        routes: [
                            {
                                path: '/',
                                component: {
                                    template: '<div>Hello World！</div>'
                                }
                            },
                            // 动态路径参数 以冒号开头
                            {
                                path: '/chart', component: {
                                    template: '<chart></chart>'
                                }
                            }
                        ]
                    });
                    this.vm = new Vue({
                        el: '#app',
                        data: {
                            memuList: [],
                            loading: true,
                            navselected: ''
                        },
                        //store: store,
                        router: this.router,
                        methods: {
                            gochart: function (that) {
                                var el = that.$el;
                                this.$router.push({
                                    path: '/chart',
                                    query: {
                                        id: el.getAttribute('data-id'),
                                        index: el.getAttribute('data-index')
                                    }
                                })
                            }
                        }
                    });  

                    return this;
                },
                createMenu: function () {
                    Utils.get('/api/menu', null, function (rs) {
                        if (rs.Success) {
                            this.vm.memuList = rs.Data;
                            this.vm.loading = false;
                        } else {
                            this.vm.$alert(rs.Msg, "错误消息");
                        }
                    }.bind(this));
                    return this;
                },
                run: function () {
                    //创建Vue
                    this.createVue()
                        .createMenu();

                }
            }).run();
        });
    </script>
</body>
</html>